<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Family Calendar</title>
  <style>
    body { margin: 0; font-family: sans-serif; background: #fefefe; color: #333; }
    .date-bar { background: #007acc; color: white; padding: 10px; text-align: center; font-size: 1.5em; position: fixed; width: 100%; top: 0; z-index: 1000; }
    .slide { display: none; padding: 60px 20px 20px; min-height: 100vh; box-sizing: border-box; }
    .slide.active { display: block; }
    h2 { text-align: center; margin-bottom: 10px; }
    .calendar-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 4px; }
    .calendar-grid .day { border: 1px solid #ccc; padding: 6px; font-size: 0.9em; }
    .event-block { padding: 4px; border-radius: 4px; margin-top: 4px; display: inline-block; color: #000; font-size: 0.9em; font-weight: bold; }
    .hour-label { font-weight: bold; text-align: right; padding-right: 10px; border-right: 1px solid #ccc; background-color: #f8f8f8; }
    .dinner, .birthdays, .chores { max-width: 600px; margin: 0 auto; font-size: 1.1em; }
    .reminder { font-size: 1.4em; text-align: center; margin-top: 100px; }

    /* event-block category colors */
    .appt { background-color: #ffd966; }  /* yellow */
    .school { background-color: #d9ead3; }  /* green */
    .work { background-color: #f9cb9c; }  /* orange */
    .house { background-color: #a4c2f4; }  /* blue */
    .other { background-color: #e0e0e0; }  /* grey */
  </style>
</head>
<body>
  <div class="date-bar" id="dateBar"></div>
  <div id="slides">
    <div class="slide" id="calendar-am"><h2>Weekly Calendar (AM)</h2><div class="calendar-grid" id="calendarAM"></div></div>
    <div class="slide" id="calendar-pm"><h2>Weekly Calendar (PM)</h2><div class="calendar-grid" id="calendarPM"></div></div>
    <div class="slide" id="dinner-slide"><h2>Dinner This Week</h2><div class="dinner" id="dinners"></div></div>
    <div class="slide" id="birthday-slide"><h2>Birthdays This Week</h2><div class="birthdays" id="birthdays"></div></div>
    <div class="slide" id="trash-slide"><div class="reminder">Trash goes out tomorrow</div></div>
    <div class="slide" id="grocery-slide"><div class="reminder">Grocery day tomorrow. Make sure to add to list</div></div>
    <div class="slide" id="chores-slide"><h2>Daily Chores</h2><div class="chores" id="chores"></div></div>
  </div>

  <script>
    const dateBar = document.getElementById("dateBar");
    const today = new Date();
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    dateBar.innerText = today.toLocaleDateString(undefined, options);

    const dayOfWeek = today.toLocaleDateString(undefined, { weekday: 'long' });

    const slides = [
      "calendar-am",
      "calendar-pm",
      "dinner-slide",
      "birthday-slide",
      ...(dayOfWeek === "Monday" ? ["trash-slide"] : []),
      ...(dayOfWeek === "Saturday" ? ["grocery-slide"] : []),
      "chores-slide"
    ];

    let current = 0;
    function showSlide(index) {
      slides.forEach(id => document.getElementById(id).classList.remove("active"));
      document.getElementById(slides[index]).classList.add("active");
    }
    showSlide(current);
    setInterval(() => {
      current = (current + 1) % slides.length;
      showSlide(current);
    }, 30000);

    function buildCalendarSection(containerElement, startHour, endHour, calendarData) {
      const days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

      // Add header row
      let headerRow = `<div class="hour-label"></div>`;
      days.forEach(day => {
        headerRow += `<div class="day-label">${day}</div>`;
      });
      containerElement.innerHTML += `<div class="calendar-header">${headerRow}</div>`;

      // Add hour rows
      for (let hour = startHour; hour <= endHour; hour++) {
        let row = `<div class="hour-label">${hour}:00</div>`;
        days.forEach(day => {
          const event = (calendarData || []).find(e => e.day === day && e.hour === hour);
          row += `<div class="day">${event ? `<div class="event-block ${event.category}">${event.event}</div>` : ""}</div>`;
        });
        containerElement.innerHTML += row;
      }
    }

    fetch("assets/data.json")
      .then(res => res.json())
      .then(data => {
        const calendarAM = document.getElementById("calendarAM");
        const calendarPM = document.getElementById("calendarPM");

        buildCalendarSection(calendarAM, 7, 14, data.calendar);  // AM calendar
        buildCalendarSection(calendarPM, 15, 22, data.calendar); // PM calendar

        const dinners = document.getElementById("dinners");
        Object.entries(data.dinners || {}).forEach(([day, meal]) => {
          dinners.innerHTML += `<p><strong>${day}:</strong> ${meal}</p>`;
        });

        const birthdays = document.getElementById("birthdays");
        (data.birthdays || []).forEach(b => {
          birthdays.innerHTML += `<p>${b.name} â€” ${b.date}</p>`;
        });

        const chores = document.getElementById("chores");
        (data.chores?.[dayOfWeek] || []).forEach(chore => {
          chores.innerHTML += `<p>${chore}</p>`;
        });
      });
  </script>
</body>
</html>
